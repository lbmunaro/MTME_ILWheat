
R version 4.4.2 (2024-10-31) -- "Pile of Leaves"
Copyright (C) 2024 The R Foundation for Statistical Computing
Platform: x86_64-redhat-linux-gnu

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> # Multi-Trait Multi-Environment models ----
> # This script fits Multi-Trait Multi-Environment models
> 
> # Objective ----
> # - 
> 
> # Clean workspace
> rm(list = objects())  # Removes all objects from the environment.
> 
> # Packages ----
> library(tidyverse) # R packages for data science.
── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.1     ✔ tibble    3.2.1
✔ lubridate 1.9.4     ✔ tidyr     1.3.1
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors
> library(asreml) # ASReml-R package.
Loading required package: Matrix

Attaching package: ‘Matrix’

The following objects are masked from ‘package:tidyr’:

    expand, pack, unpack

Online License checked out Wed Jan 29 15:22:23 2025
Loading ASReml-R version 4.2

> 
> # Load data ----
> ## Pheno & Ginv
> load('ILYT_Pheno-Gmatrix.RData')
> 
> # Fit FA3 model ----
> 
> ## Run model ----
> MTME_FA3.asr <- asreml(
+   Pheno_z ~ TraitEnv,
+   random = ~ fa(TraitEnv,3):vm(Gkeep, Ginv.sparse),
+   residual = ~ dsum(~ ar1(Col):ar1(Row) | TraitEnv),
+   sparse = ~ TraitEnv:Gdrop,
+   data = ILYT_Pheno,
+   na.action = na.method(x = "include"),
+   maxit = 20,
+   workspace = '128gb'
+ )
 Move    122135 [9797] to    122130 [9791]   0.000        Infinity    Infinity
 Move    122134 [9796] to    122131 [9792]   0.000       -Infinity    Infinity
 Move    122133 [9795] to    122131 [9792]   0.000       -Infinity    Infinity
 Move    122132 [9794] to    122127 [9786]   0.000       -Infinity    Infinity
 Move    122122 [9779] to    122121 [9778]   0.000       -Infinity   -Infinity
 Move    122080 [9732] to    122075 [9727]   0.000        Infinity   -Infinity
 Move    122079 [9731] to    122075 [9727]   0.000        Infinity   -Infinity
 Move    122078 [9730] to    122075 [9727]   0.000       -Infinity   -Infinity
 Move    122077 [9729] to    122076 [9728]   0.000        Infinity   -Infinity
 Move    122072 [9724] to    121978 [9618]   0.000        Infinity   -Infinity
 Move    122067 [9719] to    122065 [9717]   0.000        Infinity    Infinity
 Move    122053 [9701] to    122050 [9697]   0.000        Infinity    Infinity
 Move    122049 [9696] to    122047 [9694]   0.000        Infinity    Infinity
 Move    122038 [9682] to    122036 [9680]   0.000       -Infinity    Infinity
 Move    122037 [9681] to    122036 [9680]   0.000       -Infinity    Infinity
 Move    122030 [9674] to    122027 [9671]   0.000        Infinity    Infinity
 Move    122029 [9673] to    122027 [9671]   0.000       -Infinity    Infinity
 Move    122028 [9672] to    122027 [9671]   0.000        Infinity    Infinity
 Move    122017 [9661] to    122016 [9660]   0.000       -Infinity    Infinity
 Move    123730 [5347] to    123722 [5339]   0.000     -0.5903E+21 -0.1511E+24
 Move    123729 [5346] to    123726 [5343]   0.000      0.7379E+20 -0.7379E+20
 Move    123724 [5341] to    123723 [5340]   0.000     -0.7379E+20 -0.8301E+20
 Move    123720 [5337] to    123716 [5333]   0.000     -0.1647E+22   -Infinity
 Move    123719 [5336] to    123716 [5333] -0.2842E-13 -0.5263E+21   -Infinity
 Move    123718 [5335] to    123716 [5333] -0.7957E-31 -0.6908E+21   -Infinity
 Move    123717 [5334] to    123716 [5333]  0.3553E-14  0.4955E+22   -Infinity
 Move    123706 [5323] to    123705 [5322] -0.1356E-13 -0.3486E+20   -Infinity
 Move    123703 [5320] to    123702 [5319]  0.2246E-09  0.7184E+21   -Infinity
 Move    123623 [5240] to    123622 [5239]   0.000        Infinity    Infinity
 Move    123311 [4928] to    123308 [4925]   0.000        Infinity   -Infinity
 Move    122488 [4188] to    122486 [4186]   0.000        Infinity   -Infinity
 Move    122487 [4187] to    122486 [4186]   0.000        Infinity   -Infinity
 Move    123840 [5457] to    123837 [5454]   0.000        Infinity    Infinity
 Move    123579 [5196] to    123578 [5195]   0.000       -Infinity   -Infinity
 Move    123501 [5118] to    123492 [5109]   0.000        Infinity    Infinity
 Move    123496 [5113] to    123494 [5111]   0.000        Infinity   -Infinity
 Move    123420 [5037] to    123418 [5035]   0.000        Infinity    Infinity
 Move    123415 [5032] to    123414 [5031]   0.000       -Infinity    Infinity
 Move    123288 [4905] to    123287 [4904]   0.000        Infinity   -Infinity
 Move    123283 [4900] to    123280 [4897]   0.000        Infinity   -Infinity
 Move    123252 [4869] to      2380 [120638]   0.000        Infinity   -Infinity
 Move    123233 [4850] to    123232 [4849]   0.000        Infinity    Infinity

 *** caught segfault ***
address 0x10, cause 'memory not mapped'

Traceback:
 1: doTryCatch(return(expr), name, parentenv, handler)
 2: tryCatchOne(expr, names, parentenv, handlers[[1L]])
 3: tryCatchList(expr, classes, parentenv, handlers)
 4: tryCatch(expr, error = function(e) e)
 5: withCallingHandlers(tryCatch(expr, error = function(e) e), warning = w.handler)
 6: vsn.tryCatch.W.E(expr)
 7: vsn.tryCatch.W.E.rethrow(.Call(.NAME, ..., PACKAGE = this_info$dll_name),     call. = this_call)
 8: vs_Call("vs_main", data, list(info = ginverse, obj = asr_grm(ginverse,     data = data), mef = mkr(mef)), R.param, G.param, predict,     options, CORE_VERSION = ddd$core_version)
 9: asreml(Pheno_z ~ TraitEnv, random = ~fa(TraitEnv, 3):vm(Gkeep,     Ginv.sparse), residual = ~dsum(~ar1(Col):ar1(Row) | TraitEnv),     sparse = ~TraitEnv:Gdrop, data = ILYT_Pheno, na.action = na.method(x = "include"),     maxit = 20, workspace = "128gb")
An irrecoverable exception occurred. R is aborting now ...
